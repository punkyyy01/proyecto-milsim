<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>ORBAT - {{ regimiento.nombre }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #1a1a1a; color: #e0e0e0; font-family: 'Courier New', monospace; }
        .card { background-color: #2d2d2d; border: 1px solid #444; margin-bottom: 20px; }
        .card-header { background-color: #0f3d0f; color: #fff; font-weight: bold; }
        .badge-rango { background-color: #444; color: #fff; padding: 2px 5px; border-radius: 3px; font-size: 0.8em; }
        .badge-rol { background-color: #8B0000; color: #fff; font-size: 0.7em; margin-left: 5px; }
        .list-group-item { background-color: #2d2d2d; color: #e0e0e0; border-color: #444; }
    </style>
</head>
<body>

<div class="container mt-5">
    <h1 class="text-center mb-4 text-uppercase border-bottom pb-2">
        üìÇ {{ regimiento.nombre|default:"Sin Regimiento Configurado" }}
    </h1>

    {% if regimiento %}
        {% for compania in regimiento.companias.all %}
            <div class="row mb-5">
                <div class="col-12">
                    <h2 class="text-success">>> COMPA√ë√çA {{ compania.nombre }}</h2>
                </div>

                {% for escuadra in compania.escuadras.all %}
                <div class="col-md-6 col-lg-4">
                    <div class="card h-100">
                        <div class="card-header text-center">
                            {{ escuadra.nombre }}
                        </div>
                        <ul class="list-group list-group-flush">
                            {% for miembro in escuadra.miembros.all %}
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="badge-rango">{{ miembro.get_rango_display }}</span>
                                    {{ miembro.nombre_milsim }}
                                    
                                    {% for rol in miembro.roles_especiales.all %}
                                        <span class="badge badge-rol">{{ rol.nombre }}</span>
                                    {% endfor %}
                                </div>
                            </li>
                            {% empty %}
                            <li class="list-group-item text-muted fst-italic">Escuadra vac√≠a...</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% empty %}
                <div class="col-12"><p class="text-muted">No hay escuadras asignadas.</p></div>
                {% endfor %}
            </div>
        {% endfor %}
    {% else %}
        <div class="alert alert-warning text-center">
            ‚ö†Ô∏è No se ha encontrado el Regimiento. ¬°Ejecuta el script de importaci√≥n o cr√©alo en el Admin!
        </div>
    {% endif %}

</div>

</body>
</html>